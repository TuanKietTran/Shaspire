{
    "name": ".NET Aspire",
    // "dockerComposeFile": "../docker-compose.yml",  // Optional: If your Aspire project uses docker-compose for resources
    "service": "app",  // Optional: Matches a service in docker-compose.yml if used
    "workspaceFolder": "/workspace",
    "features": {
        "ghcr.io/devcontainers/features/docker-in-docker:2": {
            "version": "latest",
            "enableNonRootDocker": "true"
        },
        "ghcr.io/devcontainers/features/github-cli:1": {
            "version": "latest"
        }
    },
    "postCreateCommand": "dotnet restore && dotnet workload install aspire",  // Restore packages and install Aspire workload
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-dotnettools.vscode-dotnet-runtime",
                "ms-dotnettools.vscode-dotnet-aspire",  // Official Aspire extension for VS Code
                "ms-vscode-remote.remote-containers",
                "ms-azuretools.vscode-docker"
            ]
        }
    },
    "forwardPorts": [  // Forward common Aspire ports (adjust based on your AppHost)
        8080,  // Default web app port
        18888  // Aspire Dashboard
    ],
    "portsAttributes": {
        "8080": {
            "label": "Web App"
        },
        "18888": {
            "label": "Aspire Dashboard"
        }
    },
    "overrideFeatureSpec": {
        "docker-in-docker": {
            "moby": true,
            "dockerDashComposeVersion": "v2"
        }
    },
    "mounts": [
        "source=/var/run/docker.sock,target=/var/run/docker-host.sock,type=bind",
        "source=${localWorkspaceFolder}/.aspnet,target=/root/.aspnet,type=bind,consistency=cached"  // Persist HTTPS certs
    ]
}